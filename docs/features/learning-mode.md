# 兒童學習模式 (Learning Mode)

## 功能介紹

兒童學習模式是專為小三學生設計的互動式學習系統，提供三種不同的學習模式（學習、積木、聽寫），幫助學生以多種方式掌握英文單字。本功能模組涵蓋了從選擇學習內容（Level 選擇）、配置學習環境（語音選擇）、到三種學習模式的完整互動流程。系統自動將單字以每 10 個一組進行分級，提供語音發音功能，並使用視覺化設計（彩色單字標示、音節拆解）增強學習效果。所有模式都提供即時反饋和音效提示，讓學習過程更加生動有趣。

## UX 路徑

### UX0016: 選擇學習 Level

**觸發條件**：使用者進入學習模式頁面

**操作步驟**：
1. 使用者從儀表板點擊「開始複習挑戰」或直接進入學習模式
2. 系統自動載入所有單字並分組（每 10 個一組）
3. 學習模式頁面顯示 Level 選擇下拉選單
4. 使用者選擇要學習的 Level（全部單字 / Level 1 / Level 2...）

**預期結果**：
- 系統自動將單字分組為 Level（每 10 個一組）
- Level 選擇下拉選單顯示所有可用的 Level
- 選擇「全部單字」顯示所有單字
- 選擇特定 Level 只顯示該 Level 的單字
- 下拉選單顯示每個 Level 的單字數量
- 選擇後學習內容即時更新

---

### UX0017: 選擇語音

**觸發條件**：使用者在學習模式頁面

**操作步驟**：
1. 使用者在學習模式頁面
2. 系統自動載入可用的語音列表
3. 語音選擇下拉選單顯示所有可用語音
4. 系統自動選擇預設英文語音（Google US English 或第一個英文語音）
5. 使用者可以手動切換語音

**預期結果**：
- 語音選擇下拉選單顯示所有可用語音
- 每個語音顯示名稱和語言代碼
- 系統自動選擇預設英文語音
- 使用者可以切換到其他語音
- 選擇的語音會用於所有模式的語音播放

---

### UX0018: 學習模式 - 查看單字卡

**觸發條件**：使用者在學習模式頁面，選擇「學習」Tab

**操作步驟**：
1. 使用者在學習模式頁面
2. 選擇「學習」Tab
3. 系統顯示大單字卡
4. 單字以彩色顯示（母音紅色、子音藍色）

**預期結果**：
- 切換到學習模式 Tab
- 顯示大單字卡（正面）
- 單字字母以顏色標示（母音 a/e/i/o/u 為紅色，子音為藍色）
- 顯示 IPA 音標
- 顯示進度條和當前單字編號（例如：1 / 10）
- 單字卡可以點擊翻轉查看背面

---

### UX0019: 學習模式 - 切換音節顯示

**觸發條件**：使用者在學習模式，查看單字卡正面

**操作步驟**：
1. 使用者在學習模式，單字卡正面顯示中
2. 點擊「顯示音節拆解」按鈕
3. 單字下方顯示音節拆解
4. 再次點擊按鈕隱藏音節拆解

**預期結果**：
- 點擊「顯示音節拆解」後，單字下方顯示音節拆解（例如：in · ter · est · ing）
- 重音節有特殊標記（例如：′ 符號或顏色標示）
- 再次點擊按鈕變為「隱藏音節拆解」，音節拆解隱藏
- 按鈕狀態正確切換

---

### UX0020: 學習模式 - 播放語音

**觸發條件**：使用者在學習模式，查看單字卡

**操作步驟**：
1. 使用者在學習模式，單字卡顯示中
2. 點擊語音播放按鈕
3. 系統使用選定的語音播放單字發音

**預期結果**：
- 點擊語音播放按鈕後開始播放單字發音
- 播放過程中按鈕顯示播放狀態（圖示變化）
- 使用選定的語音播放（如果已選擇語音）
- 如果未選擇語音，使用預設英文語音
- 播放完成後按鈕恢復正常狀態

---

### UX0021: 學習模式 - 翻轉卡片

**觸發條件**：使用者在學習模式，查看單字卡正面

**操作步驟**：
1. 使用者在學習模式，單字卡正面顯示中
2. 點擊單字卡（或翻轉按鈕）
3. 單字卡翻轉顯示背面

**預期結果**：
- 點擊單字卡後觸發翻轉動畫
- 單字卡翻轉到背面
- 背面顯示中文定義
- 背面顯示例句（英文和中文翻譯）
- 背面顯示詞源分析（如果有）
- 再次點擊可以翻轉回正面

---

### UX0022: 學習模式 - 切換到下一個單字

**觸發條件**：使用者在學習模式，查看當前單字卡

**操作步驟**：
1. 使用者在學習模式，查看當前單字卡
2. 點擊「下一個」按鈕
3. 系統切換到下一個單字

**預期結果**：
- 點擊「下一個」按鈕後切換到下一個單字
- 如果當前是最後一個單字，切換到第一個單字（循環）
- 進度條更新顯示當前進度
- 單字編號更新（例如：2 / 10）
- 單字卡重置為正面顯示
- 音節顯示狀態重置為隱藏

---

### UX0023: 積木模式 - 播放語音

**觸發條件**：使用者在學習模式頁面，選擇「積木」Tab

**操作步驟**：
1. 使用者在學習模式頁面
2. 選擇「積木」Tab
3. 系統顯示中文定義和語音播放按鈕
4. 點擊語音播放按鈕
5. 系統播放單字發音

**預期結果**：
- 切換到積木模式 Tab
- 顯示中文定義（不顯示單字）
- 顯示語音播放按鈕
- 點擊後播放單字發音
- 使用選定的語音播放

---

### UX0024: 積木模式 - 重組字母

**觸發條件**：使用者在積木模式，已播放語音

**操作步驟**：
1. 使用者在積木模式，看到中文定義和打散的字母按鈕
2. 點擊字母按鈕，字母加入當前嘗試區域
3. 繼續點擊其他字母按鈕
4. 字母按順序組成單字

**預期結果**：
- 單字字母被打散成隨機排列的按鈕
- 點擊字母按鈕後，字母從按鈕區域移除
- 字母加入當前嘗試區域，按點擊順序排列
- 可以點擊「移除」按鈕移除最後一個字母
- 當前嘗試區域顯示已選擇的字母
- 字母按鈕區域顯示剩餘的字母

---

### UX0025: 積木模式 - 檢查答案

**觸發條件**：使用者在積木模式，已選擇一些字母

**操作步驟**：
1. 使用者在積木模式，當前嘗試區域有字母
2. 點擊「檢查」按鈕
3. 系統檢查答案是否正確
4. 顯示檢查結果

**預期結果**：
- 點擊「檢查」按鈕後開始檢查答案
- 如果答案正確：
  - 顯示「太棒了！」訊息（綠色）
  - 顯示正確答案
  - 播放成功音效（上升音調）
  - 顯示「下一個」按鈕
- 如果答案錯誤：
  - 顯示「再試一次！」訊息（紅色）
  - 顯示正確答案
  - 可以重新嘗試
- 檢查後字母按鈕和輸入區域禁用，直到點擊「下一個」

---

### UX0026: 聽寫模式 - 播放語音

**觸發條件**：使用者在學習模式頁面，選擇「聽寫」Tab

**操作步驟**：
1. 使用者在學習模式頁面
2. 選擇「聽寫」Tab
3. 系統顯示中文定義和語音播放按鈕
4. 點擊語音播放按鈕
5. 系統播放單字發音

**預期結果**：
- 切換到聽寫模式 Tab
- 顯示中文定義（不顯示單字）
- 顯示語音播放按鈕
- 點擊後播放單字發音
- 使用選定的語音播放
- 可以重複播放

---

### UX0027: 聽寫模式 - 輸入單字

**觸發條件**：使用者在聽寫模式，已播放語音

**操作步驟**：
1. 使用者在聽寫模式，看到中文定義和輸入框
2. 在輸入框中輸入英文單字
3. 輸入框即時顯示輸入的文字

**預期結果**：
- 輸入框可以輸入文字
- 輸入框自動獲得焦點（方便快速輸入）
- 輸入的文字即時顯示
- 輸入框有適當的大小和字體（方便閱讀）
- 可以清除輸入重新輸入

---

### UX0028: 聽寫模式 - 檢查答案

**觸發條件**：使用者在聽寫模式，已輸入單字

**操作步驟**：
1. 使用者在聽寫模式，輸入框中有文字
2. 點擊「檢查」按鈕或按 Enter 鍵
3. 系統檢查答案是否正確
4. 顯示檢查結果

**預期結果**：
- 點擊「檢查」或按 Enter 後開始檢查答案
- 答案比較不區分大小寫
- 如果答案正確：
  - 輸入框變為綠色邊框和背景
  - 顯示「太棒了！」訊息（綠色，動畫效果）
  - 播放成功音效（上升音調）
  - 輸入框禁用
  - 顯示「下一個」按鈕
- 如果答案錯誤：
  - 輸入框變為紅色邊框和背景
  - 顯示「正確答案是: [單字]」訊息（紅色）
  - 可以重新輸入
- 檢查後可以點擊「下一個」繼續下一個單字

---

## 程式碼位置

- 主組件：`components/LearningMode.tsx`
- 學習模式：`components/LearningModeTab.tsx`
- 積木模式：`components/BlockModeTab.tsx`
- 聽寫模式：`components/DictationModeTab.tsx`
- 彩色單字組件：`components/ColoredWord.tsx`
- 分組服務：`services/levelService.ts`
  - `groupCardsByLevel()` - 將單字分組為 Level
  - `getCardsByLevel()` - 取得指定 Level 的單字
  - `getTotalLevels()` - 取得總 Level 數
- 語音服務：`services/speechService.ts`
  - `getAvailableVoices()` - 取得可用語音列表
  - `speakWord()` - 播放單字發音
  - `findDefaultEnglishVoice()` - 尋找預設英文語音
- 音效服務：`services/soundService.ts`
  - `playCorrectSound()` - 播放答對音效
  - `playWrongSound()` - 播放錯誤音效
- 儲存服務：`services/storageService.ts` (getCards)
- 型別定義：`types.ts` (Flashcard, LearningMode, LearningLevel)

## UI 元素

- Level 選擇下拉選單（全部單字 / Level 1 / Level 2...）
- 三種學習模式的 Tabs 切換（學習、積木、聽寫）
- 語音選擇下拉選單
- 大單字卡顯示（母音紅色、子音藍色）
- 音節拆解顯示/隱藏切換（含重音節標記）
- 語音播放按鈕
- 卡片翻轉功能
- 字母打散重組（積木模式）
- 鍵盤輸入（聽寫模式）
- 進度條顯示
- 答案檢查按鈕
- 結果反饋顯示

## 關鍵功能

- 自動分組：程式啟動時將單字以每10個一組進行分級
- Level 選擇：可選擇特定 Level 或全部單字
- 語音發音：使用瀏覽器 SpeechSynthesis API，支援語音選擇
- 音效反饋：答對時播放成功音效（上升音調）
- 學習模式：大單字卡、顏色標示（母音紅色、子音藍色）、音節拆解、重音節標記
- 積木模式：字母打散成隨機按鈕，點擊重組單字，答對時播放音效
- 聽寫模式：播放語音和顯示中文，鍵盤輸入完整單字，答對時播放音效
- 響應式設計：支援手機、iPad、桌面裝置

